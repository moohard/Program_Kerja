import{r as n,j as s,l as r,y as i}from"./main-CKtUqjP5.js";const S=()=>{const[u,o]=n.useState([]),[x,g]=n.useState([]),[a,d]=n.useState(null),[p,c]=n.useState(!0),[m,h]=n.useState(!1);n.useEffect(()=>{(async()=>{c(!0);try{const[t,l]=await Promise.all([r.get("/roles"),r.get("/permissions")]);o(t.data),g(l.data)}catch(t){i.error("Gagal memuat data role dan permission."),console.error(t)}finally{c(!1)}})()},[]);const b=e=>{const t={...e,permissionsSet:new Set(e.permissions.map(l=>l.name))};d(t)},f=e=>{if(!a)return;const t=new Set(a.permissionsSet);t.has(e)?t.delete(e):t.add(e),d({...a,permissionsSet:t})},j=async()=>{if(a){h(!0);try{const e={permissions:Array.from(a.permissionsSet)};await r.post(`/roles/${a.id}/permissions`,e),i.success(`Hak akses untuk role ${a.name} berhasil diperbarui.`);const t=await r.get("/roles");o(t.data)}catch(e){i.error(e.response?.data?.message||"Gagal menyimpan perubahan."),console.error(e)}finally{h(!1)}}};return p?s.jsx("div",{className:"text-center py-10",children:"Loading..."}):s.jsxs("div",{className:"container mx-auto p-4",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Manajemen Role & Hak Akses"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"md:col-span-1 bg-white p-4 rounded-lg shadow",children:[s.jsx("h2",{className:"text-lg font-semibold border-b pb-2 mb-2",children:"Daftar Role"}),s.jsx("ul",{children:u.map(e=>s.jsx("li",{children:s.jsx("button",{onClick:()=>b(e),className:`w-full text-left p-2 rounded ${a?.id===e.id?"bg-blue-500 text-white":"hover:bg-gray-100"}`,children:e.name})},e.id))})]}),s.jsxs("div",{className:"md:col-span-2 bg-white p-4 rounded-lg shadow",children:[s.jsxs("h2",{className:"text-lg font-semibold border-b pb-2 mb-2",children:["Hak Akses untuk: ",a?s.jsx("span",{className:"font-bold text-blue-600",children:a.name}):"Pilih Role"]}),a?s.jsxs("div",{children:[s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto p-1",children:x.map(e=>s.jsxs("label",{className:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 border",children:[s.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-0.5",checked:a.permissionsSet.has(e.name),onChange:()=>f(e.name)}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-800",children:e.name}),s.jsx("p",{className:"text-xs text-gray-500",children:e.description})]})]},e.name))}),s.jsx("div",{className:"mt-6 text-right",children:s.jsx("button",{onClick:j,disabled:m,className:"bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:bg-blue-300",children:m?"Menyimpan...":"Simpan Perubahan"})})]}):s.jsx("div",{className:"text-gray-500 pt-10 text-center",children:"Pilih salah satu role dari daftar di sebelah kiri untuk melihat dan mengubah hak aksesnya."})]})]})]})};export{S as default};
