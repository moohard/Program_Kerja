import{r as t,l as d,j as e}from"./main-CKtUqjP5.js";import{S as i,C as w}from"./CategoryProgressChart-EbNc1r5F.js";import{c as x,l as v,a as N,b as k,d as P,n as _}from"./index-B1BQ6o6j.js";const E=()=>{const[p,j]=t.useState([]),[r,c]=t.useState(""),[s,o]=t.useState(null),[m,g]=t.useState(!1),[n,u]=t.useState(!1);t.useEffect(()=>{d.get("/program-kerja").then(a=>{const l=a.data.data;j(l);const h=l.find(y=>y.is_aktif);h&&c(h.id)})},[]),t.useEffect(()=>{r&&(g(!0),o(null),d.get(`/reports/annual-summary?program_kerja_id=${r}`).then(a=>{o(a.data)}).catch(a=>{console.error("Failed to fetch annual report:",a),o(null)}).finally(()=>g(!1)))},[r]);const f=()=>{r&&(u(!0),d.post("/reports/export-annual-summary",{program_kerja_id:r,format:"pdf"}).then(a=>{a.data.download_url&&window.open(a.data.download_url,"_blank")}).catch(a=>{console.error("Failed to export report:",a)}).finally(()=>{u(!1)}))},b=s?.summary?Object.values(s.summary).reduce((a,l)=>a+l,0):0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{htmlFor:"program-kerja-select",className:"font-semibold",children:"Pilih Tahun Program:"}),e.jsxs("select",{id:"program-kerja-select",value:r,onChange:a=>c(a.target.value),className:"block w-full max-w-xs border-gray-300 rounded-md shadow-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Pilih tahun"}),p.map(a=>e.jsx("option",{value:a.id,children:a.tahun},a.id))]})]}),e.jsxs("button",{onClick:f,disabled:!r||m||n,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed",children:[n?e.jsx(x,{className:"animate-spin -ml-1 mr-2 h-5 w-5"}):e.jsx(v,{className:"-ml-1 mr-2 h-5 w-5"}),n?"Mengekspor...":"Ekspor ke PDF"]})]}),m?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"loader"})}):s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(i,{title:"Total Rencana Aksi",value:b,icon:e.jsx(N,{size:24}),color:"blue"}),e.jsx(i,{title:"Selesai",value:s.summary.completed||0,icon:e.jsx(k,{size:24}),color:"green"}),e.jsx(i,{title:"Dalam Pengerjaan",value:s.summary.in_progress||0,icon:e.jsx(x,{size:24}),color:"yellow"}),e.jsx(i,{title:"Terlambat",value:s.summary.overdue||0,icon:e.jsx(P,{size:24}),color:"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(w,{data:s.progress_by_category})}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(_,{className:"mr-2 text-yellow-500"}),"Pencapaian Utama"]}),e.jsx("ul",{className:"space-y-3",children:s.highlights&&s.highlights.length>0?s.highlights.map(a=>e.jsxs("li",{className:"text-sm text-gray-700 p-2 bg-green-50 rounded-md",children:[e.jsxs("span",{className:"font-semibold",children:[a.kegiatan.nama_kegiatan,":"]})," ",a.deskripsi_aksi]},a.id)):e.jsx("p",{className:"text-sm text-gray-500",children:"Tidak ada pencapaian prioritas tinggi yang tercatat."})})]})]})]}):e.jsx("div",{className:"text-center text-gray-500 p-8 bg-white rounded-lg shadow-sm",children:"Pilih tahun program untuk melihat laporan."})]})};export{E as default};
