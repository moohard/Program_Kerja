import{j as e,r as d,A as R,L as q,l as w,y as A}from"./main-CKtUqjP5.js";import{P as G}from"./PageMeta-GBo2X9la.js";import{e as V,f as $,g as W,d as E,h as z,i as K}from"./index-B1BQ6o6j.js";import{s as J}from"./ConfirmationToast-CIdDE9v9.js";const B=({node:n,level:u,selectedUser:b,onUserChange:h})=>{const g={marginLeft:`${u*20}px`};return e.jsxs("div",{style:g,className:"my-1",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:n.nama_jabatan}),e.jsx("div",{className:"pl-4 border-l-2 border-gray-200",children:n.users&&n.users.length>0?n.users.map(o=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-1 rounded hover:bg-indigo-50",children:[e.jsx("input",{type:"radio",name:"assigned_to",value:o.id,checked:b==o.id,onChange:h,className:"form-radio h-4 w-4 text-indigo-600","data-cy":`user-radio-button-${o.id}`}),e.jsx("span",{className:"text-gray-800",children:o.name})]},o.id)):e.jsx("p",{className:"text-xs text-gray-400 italic",children:"Tidak ada pengguna"})}),n.children&&n.children.map(o=>e.jsx(B,{node:o,level:u+1,selectedUser:b,onUserChange:h},o.id))]})},Y=({jabatanTree:n,selectedUser:u,onChange:b})=>{const h=g=>{b(g)};return e.jsxs("div",{className:"border rounded-md p-2 max-h-60 overflow-y-auto bg-gray-50",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-1 rounded hover:bg-indigo-50",children:[e.jsx("input",{type:"radio",name:"assigned_to",value:"",checked:!u,onChange:h,className:"form-radio h-4 w-4 text-indigo-600","data-cy":"user-radio-button-unassigned"}),e.jsx("span",{className:"text-gray-500 italic",children:"-- Tidak Ditugaskan --"})]}),n.map(g=>e.jsx(B,{node:g,level:0,selectedUser:u,onUserChange:h},g.id))]})},U=()=>{const{user:n}=d.useContext(R),u=n?.permissions||[];return{can:h=>u.includes(h)}},X=({currentData:n,kegiatanId:u,jabatanTree:b,onSaveSuccess:h})=>{const{user:g}=d.useContext(R),{can:o}=U(),[s,c]=d.useState({deskripsi_aksi:"",target_tanggal:"",assigned_to:"",priority:"medium",catatan:"",jadwal_tipe:"insidentil",jadwal_config:{months:[],periode:"",hari:[]}}),[l,y]=d.useState({}),[C,j]=d.useState(!1),T=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],x=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],F=r=>{const t=r?.periode||r?.interval;return t==="monthly"||t==="quarterly"?"triwulanan":t==="biannual"?"semesteran":t};d.useEffect(()=>{if(n){const r=typeof n.assigned_to=="object"&&n.assigned_to!==null?n.assigned_to.id:n.assigned_to;c({deskripsi_aksi:n.deskripsi_aksi||"",target_tanggal:n.target_tanggal?n.target_tanggal.split("T")[0]:"",assigned_to:r||"",priority:n.priority||"medium",catatan:n.catatan||"",jadwal_tipe:n.jadwal_tipe||"insidentil",jadwal_config:{months:n.jadwal_config?.months||[],periode:F(n.jadwal_config)||"",hari:n.jadwal_config?.hari||[]}})}else c({deskripsi_aksi:"",target_tanggal:"",assigned_to:"",priority:"medium",catatan:"",jadwal_tipe:"insidentil",jadwal_config:{months:[],periode:"",hari:[]}});y({})},[n]);const v=r=>{const{name:t,value:m}=r.target;c(p=>({...p,[t]:m}))},k=r=>{const{name:t,value:m}=r.target;c(p=>({...p,jadwal_config:{...p.jadwal_config,[t]:m}}))},_=r=>{c(t=>{const m=t.jadwal_config.months.includes(r)?t.jadwal_config.months.filter(p=>p!==r):[...t.jadwal_config.months,r];return{...t,jadwal_config:{...t.jadwal_config,months:m}}})},D=r=>{c(t=>{const m=t.jadwal_config.hari.includes(r)?t.jadwal_config.hari.filter(p=>p!==r):[...t.jadwal_config.hari,r];return{...t,jadwal_config:{...t.jadwal_config,hari:m}}})},M=async r=>{r.preventDefault(),j(!0),y({});const{jadwal_tipe:t,jadwal_config:m,...p}=s;let N={};t==="insidentil"||t==="bulanan"?N={months:m.months}:t==="periodik"?N={periode:m.periode}:t==="rutin"&&(N={hari:m.hari});const P={...p,jadwal_tipe:t,jadwal_config:N,kegiatan_id:u,assigned_to:o("assign rencana aksi")?s.assigned_to||null:g.id};try{n?await w.put(`/rencana-aksi/${n.id}`,P):await w.post("/rencana-aksi",P),h();const f=document.querySelector("#rencana-aksi-modal-close-btn");f&&f.click()}catch(f){f.response&&f.response.status===422?y(f.response.data.errors):(console.error("Submit error:",f),alert("Terjadi kesalahan. Silakan coba lagi."))}finally{j(!1)}},S=()=>{switch(s.jadwal_tipe){case"insidentil":case"bulanan":return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-2 border rounded-md",children:T.map((r,t)=>{const m=t+1;return e.jsxs("label",{className:"flex items-center space-x-2 p-1 rounded-md hover:bg-gray-100 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.jadwal_config.months.includes(m),onChange:()=>_(m),className:"form-checkbox h-4 w-4 text-indigo-600 rounded"}),e.jsx("span",{className:"text-sm",children:r})]},m)})});case"periodik":return e.jsxs("select",{name:"periode",value:s.jadwal_config.periode,onChange:k,className:"form-input",children:[e.jsx("option",{value:"",children:"-- Pilih Periode --"}),e.jsx("option",{value:"triwulanan",children:"Triwulanan"}),e.jsx("option",{value:"semesteran",children:"Semesteran"})]});case"rutin":return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-2 border rounded-md",children:x.map((r,t)=>e.jsxs("label",{className:"flex items-center space-x-2 p-1 rounded-md hover:bg-gray-100 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.jadwal_config.hari.includes(t),onChange:()=>D(t),className:"form-checkbox h-4 w-4 text-indigo-600 rounded"}),e.jsx("span",{className:"text-sm",children:r})]},t))});default:return null}};return e.jsx("div",{id:"rencana-aksi-modal",className:"hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto pointer-events-none",children:e.jsx("div",{className:"hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all w-full m-3 max-w-2xl mx-auto",children:e.jsxs("div",{className:"flex flex-col bg-white border shadow-sm rounded-xl pointer-events-auto",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 px-4 border-b",children:[e.jsxs("h3",{className:"font-bold text-gray-800",children:[n?"Edit":"Tambah"," Rencana Aksi"]}),e.jsxs("button",{id:"rencana-aksi-modal-close-btn",type:"button",className:"flex justify-center items-center size-7 text-sm font-semibold rounded-full border border-transparent text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none","data-hs-overlay":"#rencana-aksi-modal",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(q,{className:"flex-shrink-0 size-4"})]})]}),e.jsx("div",{className:"p-4 overflow-y-auto max-h-[70vh]",children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"deskripsi_aksi",className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi Rencana Aksi"}),e.jsx("textarea",{id:"deskripsi_aksi",name:"deskripsi_aksi",value:s.deskripsi_aksi,onChange:v,rows:"3",className:"form-textarea","data-cy":"deskripsi-input"}),l.deskripsi_aksi&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.deskripsi_aksi[0]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"assigned_to",className:"block text-sm font-medium text-gray-700 mb-1",children:"Penanggung Jawab"}),o("assign rencana aksi")?e.jsx(Y,{jabatanTree:b,selectedUser:s.assigned_to,onChange:v,"data-cy":"jabatan-selector"}):e.jsx("input",{type:"text",value:g.name,readOnly:!0,className:"form-input bg-gray-100"}),l.assigned_to&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.assigned_to[0]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"target_tanggal",className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Tanggal"}),e.jsx("input",{type:"date",id:"target_tanggal",name:"target_tanggal",value:s.target_tanggal,onChange:v,className:"form-input"}),l.target_tanggal&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.target_tanggal[0]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioritas"}),e.jsxs("select",{id:"priority",name:"priority",value:s.priority,onChange:v,className:"form-select",children:[e.jsx("option",{value:"low",children:"Rendah"}),e.jsx("option",{value:"medium",children:"Sedang"}),e.jsx("option",{value:"high",children:"Tinggi"})]}),l.priority&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.priority[0]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jadwal_tipe",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipe Jadwal"}),e.jsxs("select",{id:"jadwal_tipe",name:"jadwal_tipe",value:s.jadwal_tipe,onChange:v,className:"form-select","data-cy":"jadwal-tipe-select",children:[e.jsx("option",{value:"insidentil",children:"Insidentil (Tidak Wajib)"}),e.jsx("option",{value:"bulanan",children:"Bulanan (Wajib Lapor)"}),e.jsx("option",{value:"periodik",children:"Periodik (Otomatis)"}),e.jsx("option",{value:"rutin",children:"Rutin (Mingguan - Diabaikan di Laporan)"})]}),l.jadwal_tipe&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.jadwal_tipe[0]})]}),e.jsxs("div",{"data-cy":"jadwal-config-insidentil",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Konfigurasi Jadwal"}),S(),l.jadwal_config&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.jadwal_config[0]})]}),e.jsxs("div",{className:"flex justify-end items-center gap-x-2 py-3 px-4 border-t",children:[e.jsx("button",{type:"button",className:"btn bg-gray-100 text-gray-800 hover:bg-gray-200","data-hs-overlay":"#rencana-aksi-modal",children:"Batal"}),e.jsx("button",{type:"submit",disabled:C,className:"btn bg-indigo-600 text-white hover:bg-indigo-700 disabled:bg-indigo-300",children:C?"Menyimpan...":"Simpan"})]})]})})]})})})},Q=({rencanaAksi:n,selectedDate:u,jabatanTree:b,onClose:h})=>{const g=async s=>{J("Yakin ingin menghapus to-do ini?",async()=>{try{await w.delete(`/todo-items/${s}`),A.success("To-do berhasil dihapus."),fetchTodos()}catch{A.error("Gagal menghapus to-do.")}})},o=(s,c)=>{setTodos(l=>l.map(y=>y.id===s?{...y,...c}:y)),setHasMadeChanges(!0)};return loading||!n?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-4xl",children:e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx("div",{className:"loader w-12 h-12"})})})}):e.jsx("div",{className:"fixed inset-0 bg-transparent flex justify-center items-start z-50 overflow-y-auto pt-10",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-4xl mb-10",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"To-Do List & Progress"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:n.deskripsi_aksi}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${progress}%`}})})]}),isPIC&&e.jsxs("div",{className:"mb-4 p-3 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsx("h3",{className:"text-sm font-bold text-gray-800",children:"Tambah Tugas Baru"})}),e.jsxs("form",{onSubmit:handleAddTodo,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-4",children:[e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("label",{htmlFor:"new-todo-desc",className:"block text-xs font-medium text-gray-600 mb-1",children:"Deskripsi Tugas"}),e.jsx("input",{id:"new-todo-desc",type:"text",value:newTodoDesc,onChange:s=>setNewTodoDesc(s.target.value),placeholder:"Deskripsi tugas...",className:"w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{htmlFor:"new-todo-pelaksana",className:"block text-xs font-medium text-gray-600 mb-1",children:"Pelaksana"}),e.jsxs("select",{id:"new-todo-pelaksana",value:newTodoPelaksanaId,onChange:s=>setNewTodoPelaksanaId(s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"-- Pilih Pelaksana --"}),assignableUsers.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"new-todo-deadline",className:"block text-xs font-medium text-gray-600 mb-1",children:"Deadline"}),e.jsx("input",{id:"new-todo-deadline",type:"date",value:newTodoDeadline,onChange:s=>setNewTodoDeadline(s.target.value),min:minDate,max:maxDate,className:"w-full border-gray-300 rounded-md shadow-sm"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Tambah"})})]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:todos.map(s=>{const c=user&&user.id===s.pelaksana_id;return e.jsx("div",{className:"p-3 rounded-md border bg-gray-50",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mt-1 mr-3",children:s.progress_percentage===100?e.jsx(FiCheckCircle,{className:"text-green-500",size:20}):e.jsx(FiCircle,{className:"text-gray-400",size:20})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:`text-sm ${s.progress_percentage===100?"line-through text-gray-500":"text-gray-900"}`,children:s.deskripsi}),s.deadline&&e.jsx("span",{className:"ml-2 text-xs font-medium bg-gray-200 text-gray-800 px-2 py-0.5 rounded-full",children:new Date(s.deadline).toLocaleString("id-ID",{month:"long"})}),s.is_late_upload&&e.jsx("span",{className:"ml-2 text-xs font-medium bg-red-100 text-red-800 px-2 py-0.5 rounded-full",children:"Telat Upload"})]}),c&&s.status_approval==="not_started"&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:"Baru"})}),c&&s.status_approval==="pending_upload"&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:"Eviden Ditolak, Perlu Revisi"})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Pelaksana:",isPIC?e.jsxs("select",{value:s.pelaksana_id||"",onChange:l=>handleUpdatePelaksana(s.id,parseInt(l.target.value,10)||null),className:"ml-1 border-none bg-gray-50 text-xs p-0 focus:ring-0",children:[e.jsx("option",{value:"",children:"Belum Ditugaskan"}),assignableUsers.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}):e.jsx("span",{className:"ml-1 font-semibold",children:s.pelaksana?.name||"Belum Ditugaskan"})]}),e.jsx("div",{className:"mt-2 space-y-1",children:s.attachments?.map(l=>e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(V,{className:"mr-1"}),e.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:l.file_name})]},l.id))}),s.status_approval==="pending_approval"&&e.jsx("div",{className:"mt-2 text-xs font-semibold text-blue-600",children:"Menunggu Validasi PIC"}),isPIC&&s.status_approval==="pending_approval"&&e.jsx(ApprovalControls,{todo:s,onApprovalDone:fetchTodos,onStateChange:o,selectedMonth}),s.status_approval==="approved"&&e.jsx("div",{className:"mt-2 text-xs font-semibold text-green-600",children:"Disetujui"})]}),e.jsxs("div",{className:"ml-4 flex flex-col items-end space-y-2 w-32 flex-shrink-0",children:[c&&e.jsx(FileUploader,{todo:s,onUploadComplete:fetchTodos,selectedMonth}),isPIC&&e.jsx("button",{onClick:()=>g(s.id),className:"text-red-500 hover:text-red-700 text-xs self-end mt-auto",children:e.jsx($,{})})]})]})},s.id)})}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>h(hasMadeChanges),className:"px-4 py-2 bg-gray-200 rounded-md",children:"Tutup"})})]})})};function Z(){const{can:n}=U(),[u,b]=d.useState([]),[h,g]=d.useState([]),[o,s]=d.useState([]),[c,l]=d.useState([]),[y,C]=d.useState(""),[j,T]=d.useState(""),[x,F]=d.useState(null),[v,k]=d.useState({kategori:!1,kegiatan:!1,rencana:!1}),[_,D]=d.useState(null),[M,S]=d.useState(!1),[r,t]=d.useState(null),{user:m}=d.useContext(R);d.useEffect(()=>{(async()=>{k(i=>({...i,kategori:!0}));try{const[i,H]=await Promise.all([w.get("/kategori-utama"),w.get("/jabatan/assignable-tree")]);b(i.data.data),l(H.data)}catch(i){console.error("Error fetching initial data:",i)}finally{k(i=>({...i,kategori:!1}))}})()},[]);const p=d.useCallback(async a=>{if(a){k(i=>({...i,kegiatan:!0})),g([]),s([]),T("");try{const i=await w.get(`/kegiatan?kategori_id=${a}`);g(i.data.data)}catch(i){console.error("Error fetching kegiatan:",i)}finally{k(i=>({...i,kegiatan:!1}))}}},[]),N=d.useCallback(async()=>{if(j){k(a=>({...a,rencana:!0}));try{let a=`/rencana-aksi?kegiatan_id=${j}`;x&&(a+=`&month=${x.getMonth()+1}`);const i=await w.get(a);s(i.data.data)}catch(a){console.error("Error fetching rencana aksi:",a)}finally{k(a=>({...a,rencana:!1}))}}},[j,x]);d.useEffect(()=>{j&&N()},[j,x,N]);const P=a=>{const i=a.target.value;C(i),p(i)},f=(a=null)=>{D(a)},I=a=>{t(a),S(!0)},O=(a=!1)=>{S(!1),t(null),a&&N()},L=async a=>{J("Apakah Anda yakin ingin menghapus item ini?",async()=>{try{await w.delete(`/rencana-aksi/${a}`),N(),A.success("Rencana aksi berhasil dihapus.")}catch(i){console.error("Error deleting item:",i),A.error("Gagal menghapus item.")}})};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center space-y-4 md:space-y-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Rencana Aksi"}),n("create rencana aksi")&&e.jsxs("button",{type:"button",onClick:()=>f(null),disabled:!j,className:"btn bg-indigo-600 text-white hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed","data-hs-overlay":"#rencana-aksi-modal",children:[e.jsx(W,{className:"mr-2"}),"Tambah Rencana Aksi"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kategori",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategori Utama"}),e.jsxs("select",{id:"kategori",value:y,onChange:P,className:"form-select w-full","data-cy":"kategori-select",children:[e.jsx("option",{value:"",children:"-- Pilih Kategori --"}),u.map(a=>e.jsxs("option",{value:a.id,children:[a.nomor,". ",a.nama_kategori]},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kegiatan",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kegiatan"}),e.jsxs("select",{id:"kegiatan",value:j,onChange:a=>T(a.target.value),disabled:!y||v.kegiatan,className:"form-select w-full","data-cy":"kegiatan-select",children:[e.jsx("option",{value:"",children:"-- Pilih Kegiatan --"}),h.map(a=>e.jsx("option",{value:a.id,children:a.nama_kegiatan},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),e.jsxs("select",{id:"month",value:x?x.getMonth():"",onChange:a=>{const i=a.target.value;F(i?new Date(new Date().getFullYear(),i,1):null)},className:"form-select w-full",children:[e.jsx("option",{value:"",children:"-- Semua Bulan --"}),Array.from({length:12},(a,i)=>e.jsx("option",{value:i,children:new Date(0,i).toLocaleString("id-ID",{month:"long"})},i))]})]})]}),v.rencana?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx("div",{className:"loader"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto hidden md:block",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Penanggung Jawab"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prioritas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200","data-cy":"rencana-aksi-table-body",children:o.map(a=>e.jsxs("tr",{"data-cy":`rencana-aksi-row-${a.id}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-normal w-1/3",children:a.deskripsi_aksi}),e.jsx("td",{className:"px-6 py-4",children:a.assigned_to?.name||"-"}),e.jsx("td",{className:"px-6 py-4",children:a.priority}),e.jsx("td",{className:"px-6 py-4",children:a.monthly_status||a.status}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-green-500 h-2.5 rounded-full",style:{width:`${(x?a.monthly_progress?.progress_percentage:a.overall_progress)||0}%`}})}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:`${(x?a.monthly_progress?.progress_percentage:a.overall_progress)||0}%`}),(x?a.monthly_progress?.is_late:a.latest_progress?.is_late)?e.jsx(E,{className:"ml-2 text-yellow-500",title:"Progress dilaporkan terlambat"}):null]})}),e.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsxs("button",{onClick:()=>I(a),className:"flex items-center text-gray-600 hover:text-gray-900","data-cy":`todo-progress-button-${a.id}`,children:[e.jsx(z,{size:18}),e.jsx("span",{className:"hidden md:inline ml-2",children:"To-Do & Progress"})]}),e.jsxs("button",{type:"button",onClick:()=>f(a),className:"flex items-center text-indigo-600 hover:text-indigo-900","data-cy":`edit-rencana-aksi-button-${a.id}`,"data-hs-overlay":"#rencana-aksi-modal",children:[e.jsx(K,{size:18}),e.jsx("span",{className:"hidden md:inline ml-2",children:"Edit"})]}),e.jsxs("button",{onClick:()=>L(a.id),className:"flex items-center text-red-600 hover:text-red-900","data-cy":`delete-rencana-aksi-button-${a.id}`,children:[e.jsx($,{size:18}),e.jsx("span",{className:"hidden md:inline ml-2",children:"Hapus"})]})]})})]},a.id))})]})}),e.jsx("div",{className:"space-y-4 md:hidden",children:o.map(a=>e.jsxs("div",{className:"border rounded-lg p-4 shadow-sm space-y-3",children:[e.jsx("p",{className:"font-semibold",children:a.deskripsi_aksi}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"P. Jawab:"})," ",a.assigned_to?.name||"-"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Prioritas:"})," ",a.priority]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Status:"})," ",a.monthly_status||a.status]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Progress:"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-green-500 h-2.5 rounded-full",style:{width:`${(x?a.monthly_progress?.progress_percentage:a.overall_progress)||0}%`}})}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:`${(x?a.monthly_progress?.progress_percentage:a.overall_progress)||0}%`}),(x?a.monthly_progress?.is_late:a.latest_progress?.is_late)?e.jsx(E,{className:"ml-2 text-yellow-500",title:"Progress dilaporkan terlambat"}):null]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 border-t pt-3 mt-3",children:[e.jsxs("button",{onClick:()=>I(a),className:"flex items-center text-gray-600 hover:text-gray-900 text-sm","data-cy":`todo-progress-button-${a.id}`,children:[e.jsx(z,{size:16,className:"mr-1"})," To-Do"]}),e.jsxs("button",{type:"button",onClick:()=>f(a),className:"flex items-center text-indigo-600 hover:text-indigo-900 text-sm","data-cy":`edit-rencana-aksi-button-${a.id}`,"data-hs-overlay":"#rencana-aksi-modal",children:[e.jsx(K,{size:16,className:"mr-1"})," Edit"]}),e.jsxs("button",{onClick:()=>L(a.id),className:"flex items-center text-red-600 hover:text-red-900 text-sm","data-cy":`delete-rencana-aksi-button-${a.id}`,children:[e.jsx($,{size:16,className:"mr-1"})," Hapus"]})]})]},a.id))})]}),e.jsx(X,{currentData:_,kegiatanId:j,jabatanTree:c,onSaveSuccess:N},_?_.id:"new-item"),M&&e.jsx(Q,{rencanaAksi:r,selectedDate:x,jabatanTree:c,onClose:O})]})}const ne=()=>e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Rencana Aksi"}),e.jsx(Z,{})]});export{ne as default};
