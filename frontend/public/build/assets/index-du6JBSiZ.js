import{r as t,j as e,l as x,y as l}from"./main-CKtUqjP5.js";import{i as v,f as w}from"./index-B1BQ6o6j.js";import{s as K}from"./ConfirmationToast-CIdDE9v9.js";function S({item:i,onClose:d,onSave:c}){const[r,s]=t.useState(i?i.nama_kegiatan:""),m=n=>{n.preventDefault(),c({nama_kegiatan:r})};return e.jsx("div",{className:"fixed inset-0 bg-transparent flex justify-center items-center z-50","data-cy":"kegiatan-modal",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4",children:[i?"Edit":"Tambah"," Kegiatan"]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama Kegiatan"}),e.jsx("textarea",{value:r,onChange:n=>s(n.target.value),required:!0,rows:"4",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm","data-cy":"nama-kegiatan-input"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300","data-cy":"cancel-button",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700","data-cy":"save-kegiatan-button",children:"Simpan"})]})]})]})})}const $=()=>{const[i,d]=t.useState([]),[c,r]=t.useState([]),[s,m]=t.useState(""),[n,g]=t.useState(!1),[y,u]=t.useState(null),[j,h]=t.useState(!1),[C,p]=t.useState(null);t.useEffect(()=>{x.get("/kategori-utama").then(a=>{r(a.data.data)}).catch(()=>{l.error("Gagal memuat daftar kategori.")})},[]);const o=t.useCallback(async()=>{if(!s){d([]);return}h(!0);try{const a=await x.get(`/kegiatan?kategori_id=${s}`);d(a.data.data),p(null)}catch{p("Gagal memuat data kegiatan."),l.error("Gagal memuat data kegiatan.")}finally{h(!1)}},[s]);t.useEffect(()=>{o()},[o]);const b=(a=null)=>{if(!s){l.warn("Silakan pilih kategori utama terlebih dahulu.");return}u(a),g(!0)},f=()=>{g(!1),u(null)},k=()=>{o(),f()},N=a=>{K("Yakin ingin menghapus kegiatan ini?",async()=>{try{await x.delete(`/kegiatan/${a}`),l.success("Kegiatan berhasil dihapus."),o()}catch{l.error("Gagal menghapus kegiatan.")}})};return e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 space-y-4 md:space-y-0",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Master: Kegiatan"}),e.jsx("button",{onClick:()=>b(),disabled:!s,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300 self-start md:self-auto","data-cy":"add-kegiatan-button",children:"Tambah Kegiatan"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pilih Kategori Utama"}),e.jsxs("select",{value:s,onChange:a=>m(a.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md","data-cy":"kategori-select",children:[e.jsx("option",{value:"",children:"-- Silakan Pilih --"}),c.map(a=>e.jsxs("option",{value:a.id,children:[a.nomor,". ",a.nama_kategori]},a.id))]})]}),j?e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"loader"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nama Kegiatan"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200","data-cy":"kegiatan-table-body",children:i.map(a=>e.jsxs("tr",{"data-cy":`kegiatan-row-${a.id}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-pre-wrap",children:a.nama_kegiatan}),e.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsxs("button",{onClick:()=>b(a),className:"flex items-center text-indigo-600 hover:text-indigo-900","data-cy":`edit-kegiatan-button-${a.id}`,children:[e.jsx(v,{size:16}),e.jsx("span",{className:"hidden md:inline ml-1",children:"Edit"})]}),e.jsxs("button",{onClick:()=>N(a.id),className:"flex items-center text-red-600 hover:text-red-900","data-cy":`delete-kegiatan-button-${a.id}`,children:[e.jsx(w,{size:16}),e.jsx("span",{className:"hidden md:inline ml-1",children:"Hapus"})]})]})})]},a.id))})]})}),n&&e.jsx(S,{item:y,onClose:f,onSave:k})]})};export{$ as default};
