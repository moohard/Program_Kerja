import{r as s,j as a,l as g,y as o}from"./index-kK03ZpaK.js";import{M as w}from"./Modal-BfXnddLm.js";import{o as k,i as _,f as J}from"./index-BGJPHazr.js";import{s as C}from"./ConfirmationToast-BN4wv4dg.js";const S=({onSave:b,onCancel:j,jabatan:n,jabatanList:u})=>{const[r,d]=s.useState({nama_jabatan:"",bidang:"",parent_id:""}),[p,c]=s.useState({});s.useEffect(()=>{n&&d({nama_jabatan:n.nama_jabatan||"",bidang:n.bidang||"",parent_id:n.parent_id||""})},[n]);const i=t=>{const{name:l,value:h}=t.target;d(f=>({...f,[l]:h}))},m=t=>{t.preventDefault();const l={};if(r.nama_jabatan||(l.nama_jabatan="Nama Jabatan tidak boleh kosong."),Object.keys(l).length>0){c(l);return}b(r)},x=u.filter(t=>t.id!==n?.id);return a.jsxs("form",{onSubmit:m,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"nama_jabatan",className:"block text-sm font-medium text-gray-700",children:"Nama Jabatan"}),a.jsx("input",{type:"text",name:"nama_jabatan",id:"nama_jabatan",value:r.nama_jabatan,onChange:i,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),p.nama_jabatan&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:p.nama_jabatan})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"bidang",className:"block text-sm font-medium text-gray-700",children:"Bidang"}),a.jsxs("select",{name:"bidang",id:"bidang",value:r.bidang,onChange:i,className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[a.jsx("option",{value:"",children:"Pilih Bidang"}),a.jsx("option",{value:"pimpinan",children:"Pimpinan"}),a.jsx("option",{value:"kesekretariatan",children:"Kesekretariatan"}),a.jsx("option",{value:"kepaniteraan",children:"Kepaniteraan"}),a.jsx("option",{value:"teknis",children:"Teknis"}),a.jsx("option",{value:"hakim",children:"Hakim"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"parent_id",className:"block text-sm font-medium text-gray-700",children:"Atasan Langsung (Opsional)"}),a.jsxs("select",{name:"parent_id",id:"parent_id",value:r.parent_id,onChange:i,className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[a.jsx("option",{value:"",children:"Tidak Ada Atasan"}),x.map(t=>a.jsx("option",{value:t.id,children:t.nama_jabatan},t.id))]})]}),a.jsxs("div",{className:"flex justify-end pt-4",children:[a.jsx("button",{type:"button",onClick:j,className:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded mr-2",children:"Batal"}),a.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Simpan"})]})]})},O=()=>{const[b,j]=s.useState([]),[n,u]=s.useState(!0),[r,d]=s.useState(null),[p,c]=s.useState(!1),[i,m]=s.useState(null),x=async()=>{u(!0);try{const e=await g.get("/jabatan");j(e.data.data),d(null)}catch{d("Gagal memuat data jabatan."),o.error("Gagal memuat data jabatan.")}finally{u(!1)}};s.useEffect(()=>{x()},[]);const t=()=>{m(null),c(!0)},l=e=>{m(e),c(!0)},h=()=>{c(!1),m(null)},f=async e=>{try{i?(await g.put(`/jabatan/${i.id}`,e),o.success("Jabatan berhasil diperbarui.")):(await g.post("/jabatan",e),o.success("Jabatan berhasil ditambahkan.")),x(),h()}catch(y){const N=y.response?.data?.message||"Gagal menyimpan data.";o.error(N)}},v=async e=>{C("Apakah Anda yakin ingin menghapus jabatan ini?",async()=>{try{await g.delete(`/jabatan/${e}`),o.success("Jabatan berhasil dihapus."),x()}catch(y){const N=y.response?.data?.message||"Gagal menghapus jabatan.";o.error(N)}})};return n?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("div",{className:"text-xl",children:"Loading..."})}):r?a.jsx("div",{className:"text-red-500 text-center mt-10",children:r}):a.jsxs("div",{className:"container mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Manajemen Jabatan"}),a.jsx("div",{className:"mb-4",children:a.jsx("button",{onClick:t,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Tambah Jabatan"})}),a.jsx("div",{className:"bg-white shadow-md rounded my-6 overflow-x-auto",children:a.jsxs("table",{className:"min-w-full w-full table-auto",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-200 text-gray-600 uppercase text-sm leading-normal",children:[a.jsx("th",{className:"py-3 px-6 text-left",children:"Jabatan"}),a.jsx("th",{className:"py-3 px-6 text-center",children:"Aksi"})]})}),a.jsx("tbody",{className:"text-gray-600 text-sm font-light",children:b.map(e=>a.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:[a.jsx("td",{className:"py-3 px-6 text-left",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-bold whitespace-normal",children:e.nama_jabatan}),a.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:["Bidang: ",e.bidang||"-"]}),a.jsxs("span",{className:"text-xs text-gray-500",children:["Atasan: ",e.parent?.nama_jabatan||"-"]})]})}),a.jsx("td",{className:"py-3 px-6 text-center",children:a.jsxs("div",{className:"hs-dropdown relative inline-flex [--placement:bottom-right]",children:[a.jsx("button",{className:"hs-dropdown-toggle",children:a.jsx(k,{size:20})}),a.jsxs("div",{className:"hs-dropdown-menu transition-[opacity,margin] duration hs-dropdown-open:opacity-100 opacity-0 hidden z-10 mt-2 min-w-[10rem] bg-white shadow-md rounded-lg p-2",children:[a.jsxs("button",{onClick:()=>l(e),className:"w-full flex items-center gap-x-3.5 py-2 px-3 rounded-lg text-sm text-gray-800 hover:bg-gray-100",children:[a.jsx(_,{})," Edit"]}),a.jsxs("button",{onClick:()=>v(e.id),className:"w-full flex items-center gap-x-3.5 py-2 px-3 rounded-lg text-sm text-red-600 hover:bg-gray-100",children:[a.jsx(J,{})," Hapus"]})]})]})})]},e.id))})]})}),a.jsx(w,{isOpen:p,onClose:h,title:i?"Edit Jabatan":"Tambah Jabatan",children:a.jsx(S,{onSave:f,onCancel:h,jabatan:i,jabatanList:b})})]})};export{O as default};
