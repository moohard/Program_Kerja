import{r,j as e,l as u,y as h}from"./index-kK03ZpaK.js";import{M as C}from"./Modal-BfXnddLm.js";import{o as P,i as S,f as E}from"./index-BGJPHazr.js";import{s as F}from"./ConfirmationToast-BN4wv4dg.js";const L=({onSave:b,onCancel:f,user:i,jabatanList:j})=>{const[a,c]=r.useState({name:"",email:"",jabatan_id:"",password:"",password_confirmation:""}),[t,g]=r.useState({});r.useEffect(()=>{i&&c({name:i.name||"",email:i.email||"",jabatan_id:i.jabatan_id||"",password:"",password_confirmation:""})},[i]);const d=o=>{const{name:n,value:p}=o.target;c(w=>({...w,[n]:p}))},x=o=>{o.preventDefault();const n={};if(a.name||(n.name="Nama tidak boleh kosong."),a.email||(n.email="Email tidak boleh kosong."),a.jabatan_id||(n.jabatan_id="Jabatan harus dipilih."),!i&&!a.password&&(n.password="Password tidak boleh kosong."),a.password&&a.password!==a.password_confirmation&&(n.password_confirmation="Konfirmasi password tidak cocok."),Object.keys(n).length>0){g(n);return}b(a)};return e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nama Lengkap"}),e.jsx("input",{type:"text",name:"name",id:"name",value:a.name,onChange:d,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),t.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",id:"email",value:a.email,onChange:d,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),t.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.email})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"jabatan_id",className:"block text-sm font-medium text-gray-700",children:"Jabatan"}),e.jsxs("select",{name:"jabatan_id",id:"jabatan_id",value:a.jabatan_id,onChange:d,className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih Jabatan"}),j.map(o=>e.jsx("option",{value:o.id,children:o.nama_jabatan},o.id))]}),t.jabatan_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.jabatan_id})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:["Password ",i?"(Kosongkan jika tidak ingin diubah)":""]}),e.jsx("input",{type:"password",name:"password",id:"password",value:a.password,onChange:d,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),t.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.password})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-medium text-gray-700",children:"Konfirmasi Password"}),e.jsx("input",{type:"password",name:"password_confirmation",id:"password_confirmation",value:a.password_confirmation,onChange:d,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),t.password_confirmation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.password_confirmation})]}),e.jsxs("div",{className:"flex justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:f,className:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded mr-2",children:"Batal"}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Simpan"})]})]})},G=()=>{const[b,f]=r.useState([]),[i,j]=r.useState([]),[a,c]=r.useState(!0),[t,g]=r.useState(null),[d,x]=r.useState(!1),[o,n]=r.useState(null),p=async()=>{try{c(!0);const[s,l]=await Promise.all([u.get("/users"),u.get("/jabatan")]);f(s.data.data),j(l.data.data),g(null)}catch{g("Gagal memuat data."),h.error("Gagal memuat data.")}finally{c(!1)}};r.useEffect(()=>{p()},[]);const w=()=>{n(null),x(!0)},N=s=>{n(s),x(!0)},y=()=>{x(!1),n(null)},v=async s=>{const l={...s};l.password||(delete l.password,delete l.password_confirmation);try{let m="";o?(await u.put(`/users/${o.id}`,l),m="Pengguna berhasil diperbarui."):(await u.post("/users",l),m="Pengguna berhasil ditambahkan."),y(),console.log("Attempting to show toast with message:",m),h.success(m),p()}catch(m){const _=m.response?.data?.message||"Gagal menyimpan data.";h.error(_)}},k=async s=>{F("Apakah Anda yakin ingin menghapus pengguna ini?",async()=>{try{await u.delete(`/users/${s}`),h.success("Pengguna berhasil dihapus."),p()}catch(l){const m=l.response?.data?.message||"Gagal menghapus pengguna.";h.error(m)}})};return a?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-xl",children:"Loading..."})}):t?e.jsx("div",{className:"text-red-500 text-center mt-10",children:t}):e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Manajemen Pengguna"}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:w,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Tambah Pengguna"})}),e.jsx("div",{className:"bg-white shadow-md rounded my-6 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-gray-600 uppercase text-sm leading-normal",children:[e.jsx("th",{className:"py-3 px-6 text-left",children:"Pengguna"}),e.jsx("th",{className:"py-3 px-6 text-center",children:"Aksi"})]})}),e.jsx("tbody",{className:"text-gray-600 text-sm font-light",children:b.map(s=>e.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:[e.jsx("td",{className:"py-3 px-6 text-left",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold whitespace-normal",children:s.name}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:s.email}),e.jsx("span",{className:"text-xs text-gray-500",children:s.jabatan?.nama_jabatan||"-"})]})}),e.jsx("td",{className:"py-3 px-6 text-center",children:e.jsxs("div",{className:"hs-dropdown relative inline-flex [--placement:bottom-right]",children:[e.jsx("button",{className:"hs-dropdown-toggle",children:e.jsx(P,{size:20})}),e.jsxs("div",{className:"hs-dropdown-menu transition-[opacity,margin] duration hs-dropdown-open:opacity-100 opacity-0 hidden z-10 mt-2 min-w-[10rem] bg-white shadow-md rounded-lg p-2",children:[e.jsxs("button",{onClick:()=>N(s),className:"w-full flex items-center gap-x-3.5 py-2 px-3 rounded-lg text-sm text-gray-800 hover:bg-gray-100",children:[e.jsx(S,{})," Edit"]}),e.jsxs("button",{onClick:()=>k(s.id),className:"w-full flex items-center gap-x-3.5 py-2 px-3 rounded-lg text-sm text-red-600 hover:bg-gray-100",children:[e.jsx(E,{})," Hapus"]})]})]})})]},s.id))})]})}),e.jsx(C,{isOpen:d,onClose:y,title:o?"Edit Pengguna":"Tambah Pengguna",children:d&&e.jsx(L,{onSave:v,onCancel:y,user:o,jabatanList:i})})]})};export{G as default};
